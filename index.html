<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Дом Худояровых</title>
<link href="https://fonts.googleapis.com/css2?family=Arsenal+SC:wght@400;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
  body {
    margin: 0;
    background: #ffffff;
    color: #000000;
    font-family: "Roboto", sans-serif;
    -webkit-tap-highlight-color: transparent;
  }
  .container { padding: 12px; max-width: 640px; margin: auto; }
  .window {
    background: rgba(0,0,0,0.03);
    border: 1px solid rgba(0,0,0,0.1);
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 12px;
  }

  .btn {
    border: none;
    padding: 14px;
    border-radius: 35px;
    color: #ffffff;
    cursor: pointer;
    width: 100%;
    font-size: 17px;
    font-family: "Arsenal SC", sans-serif;
    margin-top: 12px;
  }
  .btn-green { background: #4C614E; }
  .btn-brown { background: #775541; }
  .btn-disabled { opacity: 0.5; pointer-events: none; }

  h2, h3 { font-family: "Arsenal SC", sans-serif; color: #000; }

  .gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 8px;
  }
  .thumb {
    width: 100%; height: 100px;
    object-fit: cover;
    border-radius: 6px;
    cursor: pointer;
  }

  @media (max-width: 480px) {
    .container { padding: 8px; }
    .btn { font-size: 16px; padding: 12px; }
    .thumb { height: 90px; }
  }
</style>
</head>
<body>
<div class="container">
  <div id="app"></div>
</div>

<script>
const tg = window.Telegram?.WebApp || null;
if (tg) tg.expand();

let images = [
  { id: genId(), name: "Demo 1", url: "https://picsum.photos/300/300?1" },
  { id: genId(), name: "Demo 2", url: "https://picsum.photos/300/300?2" },
  { id: genId(), name: "Demo 3", url: "https://picsum.photos/300/300?3" }
];

let currentScreen = { name: "start", props: {} };

function navigate(name, props = {}) {
  currentScreen = { name, props };
  render();
}

function render() {
  const root = document.getElementById("app");
  root.innerHTML = templates[currentScreen.name](currentScreen.props);
  attachEvents();
}

const templates = {
  start: () => `
    <div class="window" style="text-align:center; padding-top:20px;">
      <img src="logo2.png" alt="logo" style="width:100px; height:100px; margin-bottom:20px;" />

      <button class="btn btn-green" id="choose-scenario">Выбрать сценарий</button>
      <button class="btn btn-brown" style="margin-bottom:20px;">Случайная игра</button>
      <button class="image-button" id="ai_assistant"><img src="aiassistant.png" alt="Icon" style="width:160px; height:auto; margin-bottom:20px;"></button>

    </div>
  `,

  scenario_list: () => `
    <div class="window">
      <h3>Выберите сценарий для игры</h3>

      <div class="window" style="text-align:center; padding-top:20px;">
        <button class="btn btn-green" id="game1">Худояр потерял поднос</button>
        <button class="btn btn-green" id="fake1">Сундук Худояра не открывается</button>
        <button class="btn btn-green" id="fake2">Худояр куёт поднос</button>
        <button class="btn btn-green" id="fake3">В доме Худояра гость</button>
        <button class="btn btn-green" id="fake4">Худояр выбирает поднос для приданого</button>
      </div>

      <button class="btn btn-brown" id="back">Назад</button>
    </div>
  `,
  game1: () =>`
    <div class="window" style="text-align:center; padding-top:20px;">
      <img src="podnos1.png" alt="logo" style="width:160px; height:auto; margin-bottom:20px;" />
     <p>Худояр собирается на день рождения к своему другу и хочет подарить ему свой лучший поднос. Правда он забыл, какой именно из своих лучших подносов он хочет подарить. \n\nПомоги Худояру найти тот самый поднос, которому обрадуется его друг!</p>
      <button class="btn btn-green" id="quest1">Начать квест!</button>
  
     `,
      quest1:()=>`
      <div class="window" style="text-align:center; padding-top:20px;">
      <img src="hud1.png" alt="logo" style="width:160px; height:auto; margin-bottom:20px;" />
     <p>В последний раз, когда Худояр сортировал подносы, он повесил тот самый поднос на втором этаже своего дома.</p>
      <button class="btn btn-brown" id="answer1">Пойти на 2 этаж</button>
     `,

     answer1:()=>`
      <div class="window" style="text-align:center; padding-top:20px;">
      <img src="answer1.png" alt="logo" style="width:160px; height:auto; margin-bottom:20px;" />
     <p>Сколько девушек изображено на подносе, расположенном в центральной части зала?</p>
     <input type="text" id="uname" name="name" />
      <button class="btn btn-green" id="quest2">Ко второму заданию</button>
     `,
      
     quest2:()=>`
      <div class="window" style="text-align:center; padding-top:20px;">
      <img src="hud2.png" alt="logo" style="width:160px; height:auto; margin-bottom:20px;" />
     <p>Точно, в последний раз Худояр видел его на втором этаже, но точно ли в этом углу? \n\nХудояру уже скоро выходить, а он всё ещё не нашёл поднос, нужно ускоряться!</p>
      <button class="btn btn-brown" id="answer2">Осмотреться в зале</button>
     `,

         answer2:()=>`
      <div class="window" style="text-align:center; padding-top:20px;">
      <img src="answer2.png" alt="logo" style="width:160px; height:auto; margin-bottom:20px;" />
     <p>Как называется поднос, расположенный в углу зала, фоновым цветом которого является красный?</p>
     <input type="text" id="uname" name="name" />
      <button class="btn btn-green" id="quest3">К третьему заданию</button>
     `,

      quest3:()=>`
      <div class="window" style="text-align:center; padding-top:20px;">
      <img src="hud3.png" alt="logo" style="width:160px; height:auto; margin-bottom:20px;" />
     <p>Посмотрев на красный поднос, Худояра осенило: самый лучший поднос он повесил на первом этаже! \n\nСбежав по лестнице, Худояр начал искать тот самый зелёный поднос.</p>
      <button class="btn btn-brown" id="answer3">Подойти к подносу</button>
     `,

        answer3:()=>`
      <div class="window" style="text-align:center; padding-top:20px;">
      <img src="answer3.png" alt="logo" style="width:160px; height:auto; margin-bottom:20px;" />
     <p>Сколько бутонов цветов изображено на зелёном подносе, расположенном в углу зала первого этажа?</p>
     <input type="text" id="uname" name="name" />
      <button class="btn btn-green" id="result">Завершить квест</button>
     `,

        result:()=>`
      <div class="window" style="text-align:center; padding-top:20px;">
      <img src="logo2.png" alt="logo" style="width:160px; height:auto; margin-bottom:20px;" />
      <h3>ПОЗДРАВЛЯЕМ!</h3>
      <h3>ЛУЧШЕ, ЧЕМ 99% ИГРОКОВ</h3>
     <p>Вы справились за: 5 минут 33 секунды</p>
     <p>Количество ошибок: 0</p>
      <button class="btn btn-brown" id="mainmenu">Главное меню</button>
     `,

     ai_assistant: () => `
      <div class="window" style="text-align:center; padding-top:20px;">
        <h3>Спроси Худояра!</h3>
        <img src="aimessage.png" alt="logo" style="width:160px; height:auto; margin-bottom:20px; float:left;"/>
        <button class="btn btn-brown" id="back">Назад</button>
      </div>
  `

};

function attachEvents() {
  const choose = document.getElementById("choose-scenario");
  if (choose) choose.onclick = () => navigate("scenario_list");

  const back = document.getElementById("back");
  if (back) back.onclick = () => navigate("start");

  const game1 = document.getElementById("game1");
  if (game1) game1.onclick = () => navigate("game1");

  const quest1 = document.getElementById("quest1");
  if (quest1) quest1.onclick = () => navigate("quest1");

  const answer1 = document.getElementById("answer1");
  if (answer1) answer1.onclick = () => navigate("answer1");

  const quest2 = document.getElementById("quest2");
  if (quest2) quest2.onclick = () => navigate("quest2");

  const answer2 = document.getElementById("answer2");
  if (answer2) answer2.onclick = () => navigate("answer2");

  const quest3 = document.getElementById("quest3");
  if (quest3) quest3.onclick = () => navigate("quest3");

  const answer3 = document.getElementById("answer3");
  if (answer3) answer3.onclick = () => navigate("answer3");

  const result = document.getElementById("result");
  if (result) result.onclick = () => navigate("result");

  const mainmenu = document.getElementById("mainmenu");
  if (mainmenu) mainmenu.onclick = () => navigate("start");

   const ai_assistant = document.getElementById("ai_assistant");
  if (ai_assistant) ai_assistant.onclick = () => navigate("ai_assistant");

  document.querySelectorAll(".view-img").forEach(img => {
    img.onclick = () => navigate("viewer", { id: img.dataset.id });
  });
}

function genId() {
  return Math.random().toString(36).slice(2) + Date.now().toString(36);
}

render();
</script>
</body>
</html>
